<!doctype html>
<html lang="bg">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Поръчка — RU58841 10%</title>
<link rel="stylesheet" href="../assets/style.css">
<link rel="icon" href="../assets/favicon.png">

<style>
.hidden { display: none; }

form select, form input {
  width: 100%;
  padding: 12px;
  margin-bottom: 10px;
  box-sizing: border-box;
}

form button {
  width: 100%;
  padding: 12px;
  background: black;
  color: white;
  border: none;
  font-size: 16px;
  cursor: pointer;
}
</style>

</head>
<body>

<nav class="topnav">
  <a href="/index.html">Начало</a>
  <a href="/how-it-works.html">Как действа</a>
  <a href="/ru58841-vs-minoxidil.html">RU58841 vs Миноксидил</a>
  <a href="/ru58841-side-effects.html">Странични ефекти</a>
  <a href="/ru58841-results.html">Резултати</a>
</nav>

<h1>Поръчка — RU58841 10%</h1>

<img src="../assets/ru58841.webp" class="product-image">

<!-- Динамична цена -->
<div id="priceBox">Цена: <b>47 лв</b></div>

<form id="orderForm">

  <h2>1. Количество</h2>
  <select name="qty" id="qtySelect" required>
    <option value="1">1 брой</option>
    <option value="2">2 броя</option>
    <option value="3">3 броя</option>
  </select>

  <h2>2. Тип доставка</h2>
  <select name="delivery" id="delivery" required>
    <option value="office">До офис на куриера</option>
    <option value="address">До адрес</option>
  </select>

  <div id="officeField">
    <input type="text" name="address" placeholder="Офис на куриер (Спиди/Еконт)">
  </div>

  <div id="homeField" class="hidden">
    <input type="text" name="address" placeholder="Адрес за доставка">
  </div>

  <h2>3. Контакт</h2>
  <input type="text" name="name" placeholder="Име и фамилия" required>
  <input type="tel" name="phone" placeholder="Телефон" required>
  <input type="email" name="email" placeholder="Email" required>

  <h2>4. NFT Бележка (по желание)</h2>
  <select name="nft" id="nftSelect">
    <option value="no">Без NFT</option>
    <option value="yes">Желая NFT бележка</option>
  </select>

  <input type="text" id="walletField" name="wallet" class="hidden" placeholder="Polygon wallet (0x...)">

  <button type="submit">Изпрати поръчката</button>
</form>


<script>
// --- Динамична цена ---
const qtySelect = document.getElementById("qtySelect");
const priceBox = document.getElementById("priceBox");

function updatePrice() {
  let qty = parseInt(qtySelect.value);
  let price = 47;
  if (qty === 2) price = 81;
  if (qty === 3) price = 137;
  priceBox.innerHTML = `Цена: <b>${price} лв</b>`;
}
qtySelect.addEventListener("change", updatePrice);
updatePrice();


// --- Офис / Адрес ---
const delivery = document.getElementById("delivery");
const officeField = document.getElementById("officeField");
const homeField = document.getElementById("homeField");

delivery.addEventListener("change", () => {
  if (delivery.value === "office") {
    officeField.classList.remove("hidden");
    homeField.classList.add("hidden");
  } else {
    officeField.classList.add("hidden");
    homeField.classList.remove("hidden");
  }
});


// --- NFT поле ---
const nftSelect = document.getElementById("nftSelect");
const walletField = document.getElementById("walletField");

nftSelect.addEventListener("change", () => {
  walletField.classList.toggle("hidden", nftSelect.value !== "yes");
});


// --- Изпращане към Google Apps Script ---
document.getElementById("orderForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  // Валидация на адреса
  const addressInput = delivery.value === "office"
    ? officeField.querySelector("input")
    : homeField.querySelector("input");

  if (!addressInput.value.trim()) {
    alert("Моля, въведете адрес или офис на куриер.");
    return;
  }

  const formData = new FormData(e.target);

  // Фиксиран продукт
  formData.append("product", "RU58841 10%");

  // Изпращане
  await fetch("https://script.google.com/macros/s/AKfycbwgpvoU9ki0y_yaAQkFWudubeg5M5Az35JsDJYDNwtgWLenY6u-Z2DwLSf5yh2Wu2zV/exec", {
    method: "POST",
    mode: "no-cors",
    body: formData
  });

  // Пренасочване
  window.location.href = "../thanks.html";
});
</script>

</body>
</html>
